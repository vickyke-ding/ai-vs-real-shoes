<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shoe Classification</title>
</head>
<body>
    <h1>Is this shoe AI-generated or real?</h1>
    <img id="shoe-image" src="" alt="Loading..." width="300">
    <br><br>
    <button onclick="submitChoice('AI-Generated')">AI-Generated</button>
    <button onclick="submitChoice('Real')">Real</button>

    <script>
        const API_URL = "https://ai-vs-real-shoes.onrender.com"; 

        async function fetchImage() {
            try {
                const response = await fetch(`${API_URL}/get_image`);
                const data = await response.json();
                console.log("Fetched image:", data.image_url); // 调试信息
                document.getElementById("shoe-image").src = data.image_url;
                document.getElementById("shoe-image").dataset.label = data.label;
            } catch (error) {
                console.error("Error fetching image:", error);
                document.getElementById("shoe-image").alt = "Error fetching image";
            }
        }

        async function submitChoice(choice) {
            const imageUrl = document.getElementById("shoe-image").src;
            const label = document.getElementById("shoe-image").dataset.label;

            const response = await fetch(`${API_URL}/submit`, {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({ image_url: imageUrl, choice: choice, correct_label: label })
            });

            const result = await response.json();
            console.log("Response recorded:", result);

            // 获取新的图片
            fetchImage();
        }

        // 页面加载时获取第一张图片
        fetchImage();
    </script>
</body>
</html>
